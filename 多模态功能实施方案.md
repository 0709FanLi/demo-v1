# å¤šæ¨¡æ€åŠŸèƒ½å®æ–½æ–¹æ¡ˆ

## ğŸ“‹ ç›®æ ‡

ä¸ºç³»ç»Ÿæ·»åŠ å¤šæ¨¡æ€æ”¯æŒï¼Œèƒ½å¤Ÿå¤„ç†ï¼š
- âœ… **å›¾ç‰‡è¾“å…¥**ï¼šç”¨æˆ·ä¸Šä¼ å›¾ç‰‡è¿›è¡Œé—®ç­”
- âœ… **å›¾ç‰‡çŸ¥è¯†åº“**ï¼šå°†å›¾ç‰‡ä½œä¸ºçŸ¥è¯†å­˜å‚¨
- âœ… **PDF æ–‡æ¡£**ï¼šè§£æ PDF å¹¶å­˜å…¥çŸ¥è¯†åº“
- âœ… **æ··åˆæ£€ç´¢**ï¼šåŒæ—¶æ£€ç´¢æ–‡æœ¬å’Œå›¾ç‰‡

---

## ğŸ¯ å®æ–½æ­¥éª¤æ€»è§ˆ

| é˜¶æ®µ | ä»»åŠ¡ | é¢„è®¡æ—¶é—´ | éš¾åº¦ |
|------|------|---------|------|
| **é˜¶æ®µ1** | ç¯å¢ƒå‡†å¤‡ä¸ä¾èµ–å®‰è£… | 30åˆ†é’Ÿ | â­ ç®€å• |
| **é˜¶æ®µ2** | å›¾ç‰‡å‘é‡åŒ–æœåŠ¡ | 1-2å°æ—¶ | â­â­ ä¸­ç­‰ |
| **é˜¶æ®µ3** | PDF è§£ææœåŠ¡ | 1-2å°æ—¶ | â­â­ ä¸­ç­‰ |
| **é˜¶æ®µ4** | æ‰©å±•çŸ¥è¯†åº“æœåŠ¡ | 2-3å°æ—¶ | â­â­â­ è¾ƒéš¾ |
| **é˜¶æ®µ5** | API æ¥å£æ‰©å±• | 1-2å°æ—¶ | â­â­ ä¸­ç­‰ |
| **é˜¶æ®µ6** | å‰ç«¯ç•Œé¢æ”¹é€  | 2-3å°æ—¶ | â­â­ ä¸­ç­‰ |
| **é˜¶æ®µ7** | æµ‹è¯•ä¸ä¼˜åŒ– | 1-2å°æ—¶ | â­â­ ä¸­ç­‰ |
| **æ€»è®¡** | | **8-15å°æ—¶** | |

---

## ğŸ“¦ é˜¶æ®µ1ï¼šç¯å¢ƒå‡†å¤‡ä¸ä¾èµ–å®‰è£…

### 1.1 éœ€è¦å®‰è£…çš„ Python åŒ…

```bash
# å›¾ç‰‡å¤„ç†
pillow==10.2.0              # å›¾ç‰‡åŸºç¡€æ“ä½œ
opencv-python==4.9.0.80     # å›¾ç‰‡é¢„å¤„ç†

# å¤šæ¨¡æ€æ¨¡å‹
transformers==4.36.0        # Hugging Face æ¨¡å‹åº“
torch==2.1.0                # PyTorchï¼ˆCLIP ä¾èµ–ï¼‰
torchvision==0.16.0         # å›¾ç‰‡å¤„ç†

# PDF å¤„ç†
pymupdf==1.23.0             # PDF è§£æï¼ˆä¹Ÿå« fitzï¼‰
pdf2image==1.17.0           # PDF è½¬å›¾ç‰‡
pytesseract==0.3.10         # OCRï¼ˆå¯é€‰ï¼‰

# æ–‡ä»¶å¤„ç†
python-magic==0.4.27        # æ–‡ä»¶ç±»å‹æ£€æµ‹
```

### 1.2 ç³»ç»Ÿä¾èµ–ï¼ˆå¦‚éœ€ OCRï¼‰

```bash
# macOS
brew install tesseract
brew install poppler  # pdf2image éœ€è¦

# éªŒè¯å®‰è£…
tesseract --version
pdfinfo -v
```

### 1.3 æ¨¡å‹ä¸‹è½½

éœ€è¦ä¸‹è½½çš„æ¨¡å‹ï¼š
- **CLIP æ¨¡å‹**ï¼š`openai/clip-vit-base-patch32` (~600MB)
- **æˆ–ä½¿ç”¨ä¸­æ–‡ä¼˜åŒ–ç‰ˆ**ï¼š`OFA-Sys/chinese-clip-vit-base-patch16` (~800MB)

æ¨¡å‹ä¼šè‡ªåŠ¨ä¸‹è½½åˆ°ï¼š`~/.cache/huggingface/`

---

## ğŸ–¼ï¸ é˜¶æ®µ2ï¼šå›¾ç‰‡å‘é‡åŒ–æœåŠ¡

### 2.1 åˆ›å»ºå¤šæ¨¡æ€ç¼–ç å™¨

**æ–°å»ºæ–‡ä»¶**ï¼š`backend/src/services/multimodal_encoder.py`

**åŠŸèƒ½**ï¼š
```python
class MultiModalEncoder:
    """å¤šæ¨¡æ€ç¼–ç å™¨ï¼ˆæ–‡æœ¬+å›¾ç‰‡ï¼‰"""
    
    def __init__(self):
        # åŠ è½½ CLIP æ¨¡å‹
        self.model = CLIPModel.from_pretrained("openai/clip-vit-base-patch32")
        self.processor = CLIPProcessor.from_pretrained("openai/clip-vit-base-patch32")
    
    def encode_text(self, text: str) -> np.ndarray:
        """æ–‡æœ¬ç¼–ç ï¼ˆ512ç»´ï¼‰"""
        pass
    
    def encode_image(self, image_path: str) -> np.ndarray:
        """å›¾ç‰‡ç¼–ç ï¼ˆ512ç»´ï¼‰"""
        pass
    
    def encode_image_from_bytes(self, image_bytes: bytes) -> np.ndarray:
        """ä»å­—èŠ‚æµç¼–ç å›¾ç‰‡"""
        pass
```

**å…³é”®ç‚¹**ï¼š
- âœ… CLIP æ¨¡å‹è¾“å‡º 512 ç»´å‘é‡
- âœ… æ–‡æœ¬å’Œå›¾ç‰‡åœ¨åŒä¸€å‘é‡ç©ºé—´
- âœ… å¯ä»¥ç›´æ¥è®¡ç®—è·¨æ¨¡æ€ç›¸ä¼¼åº¦

---

## ğŸ“„ é˜¶æ®µ3ï¼šPDF è§£ææœåŠ¡

### 3.1 åˆ›å»º PDF å¤„ç†å™¨

**æ–°å»ºæ–‡ä»¶**ï¼š`backend/src/services/pdf_processor.py`

**åŠŸèƒ½**ï¼š
```python
class PDFProcessor:
    """PDF æ–‡æ¡£å¤„ç†å™¨"""
    
    def extract_text(self, pdf_path: str) -> List[str]:
        """æå– PDF æ–‡æœ¬ï¼ˆæŒ‰é¡µï¼‰"""
        pass
    
    def extract_images(self, pdf_path: str) -> List[bytes]:
        """æå– PDF ä¸­çš„å›¾ç‰‡"""
        pass
    
    def convert_to_images(self, pdf_path: str) -> List[Image]:
        """å°† PDF é¡µé¢è½¬ä¸ºå›¾ç‰‡ï¼ˆç”¨äº OCRï¼‰"""
        pass
    
    def process_pdf(self, pdf_path: str) -> Dict:
        """å®Œæ•´å¤„ç†ï¼šæ–‡æœ¬+å›¾ç‰‡"""
        return {
            'texts': [...],      # æ–‡æœ¬å†…å®¹
            'images': [...],     # å›¾ç‰‡åˆ—è¡¨
            'metadata': {...}    # å…ƒæ•°æ®
        }
```

**å¤„ç†æµç¨‹**ï¼š
1. å°è¯•æå–æ–‡æœ¬ï¼ˆåŸç”Ÿæ–‡æœ¬ï¼‰
2. å¦‚æœæ–‡æœ¬ä¸ºç©ºï¼Œä½¿ç”¨ OCR
3. æå–æ‰€æœ‰å›¾ç‰‡
4. åˆ†åˆ«å‘é‡åŒ–å­˜å‚¨

---

## ğŸ—„ï¸ é˜¶æ®µ4ï¼šæ‰©å±•çŸ¥è¯†åº“æœåŠ¡

### 4.1 ä¿®æ”¹ Milvus Collection Schema

**å½“å‰ Schema**ï¼ˆ384ç»´ï¼Œçº¯æ–‡æœ¬ï¼‰ï¼š
```python
fields = [
    FieldSchema(name='id', dtype=DataType.VARCHAR, is_primary=True),
    FieldSchema(name='content', dtype=DataType.VARCHAR),
    FieldSchema(name='vector', dtype=DataType.FLOAT_VECTOR, dim=384),  # å½“å‰
    FieldSchema(name='category', dtype=DataType.VARCHAR),
]
```

**æ–° Schema**ï¼ˆ512ç»´ï¼Œå¤šæ¨¡æ€ï¼‰ï¼š
```python
fields = [
    FieldSchema(name='id', dtype=DataType.VARCHAR, max_length=100, is_primary=True),
    FieldSchema(name='content', dtype=DataType.VARCHAR, max_length=65535),
    FieldSchema(name='vector', dtype=DataType.FLOAT_VECTOR, dim=512),  # æ”¹ä¸º 512
    FieldSchema(name='category', dtype=DataType.VARCHAR, max_length=100),
    
    # æ–°å¢å­—æ®µ
    FieldSchema(name='content_type', dtype=DataType.VARCHAR, max_length=20),  # text/image/pdf
    FieldSchema(name='file_path', dtype=DataType.VARCHAR, max_length=500),    # æ–‡ä»¶è·¯å¾„
    FieldSchema(name='file_size', dtype=DataType.INT64),                      # æ–‡ä»¶å¤§å°
    FieldSchema(name='image_url', dtype=DataType.VARCHAR, max_length=500),    # å›¾ç‰‡URLï¼ˆå¯é€‰ï¼‰
    FieldSchema(name='parent_id', dtype=DataType.VARCHAR, max_length=100),    # çˆ¶æ–‡æ¡£IDï¼ˆPDFé¡µé¢ï¼‰
]
```

### 4.2 æ•°æ®è¿ç§»ç­–ç•¥

**é—®é¢˜**ï¼šç°æœ‰æ•°æ®æ˜¯ 384 ç»´ï¼Œæ–°æ¨¡å‹æ˜¯ 512 ç»´

**æ–¹æ¡ˆA**ï¼šæ¸…ç©ºé‡å»ºï¼ˆæ¨èï¼Œæ•°æ®é‡å°ï¼‰
```python
# 1. å¤‡ä»½ç°æœ‰æ•°æ®
# 2. åˆ é™¤æ—§ Collection
# 3. åˆ›å»ºæ–° Collectionï¼ˆ512ç»´ï¼‰
# 4. é‡æ–°æ·»åŠ æ•°æ®
```

**æ–¹æ¡ˆB**ï¼šåŒ Collection å¹¶å­˜
```python
# knowledge_base_v1 (384ç»´ï¼Œæ—§æ•°æ®)
# knowledge_base_v2 (512ç»´ï¼Œæ–°æ•°æ®)
# æ£€ç´¢æ—¶åŒæ—¶æŸ¥è¯¢ä¸¤ä¸ª
```

### 4.3 æ‰©å±• KnowledgeService

**æ–°å¢æ–¹æ³•**ï¼š
```python
class KnowledgeService:
    # ç°æœ‰æ–¹æ³•
    async def add_knowledge(self, knowledge: KnowledgeCreate) -> str:
        """æ·»åŠ æ–‡æœ¬çŸ¥è¯†ï¼ˆå·²æœ‰ï¼‰"""
        pass
    
    # æ–°å¢æ–¹æ³•
    async def add_image(
        self,
        image_file: UploadFile,
        category: str,
        description: str = ""
    ) -> str:
        """æ·»åŠ å›¾ç‰‡çŸ¥è¯†"""
        # 1. ä¿å­˜å›¾ç‰‡åˆ°æœ¬åœ°/å¯¹è±¡å­˜å‚¨
        # 2. ä½¿ç”¨ CLIP ç¼–ç å›¾ç‰‡
        # 3. å­˜å…¥ Milvus
        pass
    
    async def add_pdf(
        self,
        pdf_file: UploadFile,
        category: str,
        extract_images: bool = True
    ) -> List[str]:
        """æ·»åŠ  PDF æ–‡æ¡£"""
        # 1. è§£æ PDFï¼ˆæ–‡æœ¬+å›¾ç‰‡ï¼‰
        # 2. åˆ†åˆ«å‘é‡åŒ–
        # 3. å…³è”å­˜å‚¨ï¼ˆparent_idï¼‰
        pass
    
    async def search_multimodal(
        self,
        query: str = None,
        image: UploadFile = None,
        content_type: str = None,
        top_k: int = 5
    ) -> List[SearchResult]:
        """å¤šæ¨¡æ€æ£€ç´¢"""
        # 1. å¦‚æœæœ‰æ–‡æœ¬ï¼Œç¼–ç æ–‡æœ¬
        # 2. å¦‚æœæœ‰å›¾ç‰‡,ç¼–ç å›¾ç‰‡
        # 3. æ··åˆæ£€ç´¢æˆ–å•ç‹¬æ£€ç´¢
        pass
```

---

## ğŸ”Œ é˜¶æ®µ5ï¼šAPI æ¥å£æ‰©å±•

### 5.1 æ–°å¢çŸ¥è¯†åº“æ¥å£

**æ–‡ä»¶**ï¼š`backend/src/api/routers/knowledge.py`

**æ–°å¢æ¥å£**ï¼š

```python
@router.post('/upload-image')
async def upload_image(
    file: UploadFile = File(...),
    category: str = Form(...),
    description: str = Form(""),
):
    """ä¸Šä¼ å›¾ç‰‡åˆ°çŸ¥è¯†åº“"""
    pass

@router.post('/upload-pdf')
async def upload_pdf(
    file: UploadFile = File(...),
    category: str = Form(...),
    extract_images: bool = Form(True),
):
    """ä¸Šä¼  PDF åˆ°çŸ¥è¯†åº“"""
    pass

@router.post('/search-by-image')
async def search_by_image(
    file: UploadFile = File(...),
    top_k: int = Form(5),
):
    """ä»¥å›¾æœå›¾"""
    pass
```

### 5.2 ä¿®æ”¹ RAG æ¥å£

**æ–‡ä»¶**ï¼š`backend/src/api/routers/chat.py`

**å¢å¼ºç°æœ‰æ¥å£**ï¼š

```python
@router.post('/chat-with-image')
async def chat_with_image(
    question: str = Form(...),
    image: UploadFile = File(None),  # å¯é€‰å›¾ç‰‡
    use_knowledge_base: bool = Form(True),
):
    """å›¾æ–‡æ··åˆå¯¹è¯"""
    # 1. æ£€ç´¢çŸ¥è¯†åº“ï¼ˆæ–‡æœ¬+å›¾ç‰‡ï¼‰
    # 2. è°ƒç”¨å¤šæ¨¡æ€ LLMï¼ˆqwen-vl-maxï¼‰
    # 3. è¿”å›å›ç­”
    pass
```

---

## ğŸ¨ é˜¶æ®µ6ï¼šå‰ç«¯ç•Œé¢æ”¹é€ 

### 6.1 æ·»åŠ æ–‡ä»¶ä¸Šä¼ ç»„ä»¶

**æ–°å»º**ï¼š`frontend/src/components/FileUpload.tsx`

**åŠŸèƒ½**ï¼š
- âœ… æ”¯æŒæ‹–æ‹½ä¸Šä¼ 
- âœ… å›¾ç‰‡é¢„è§ˆ
- âœ… PDF é¢„è§ˆ
- âœ… è¿›åº¦æ¡æ˜¾ç¤º
- âœ… æ–‡ä»¶ç±»å‹éªŒè¯

### 6.2 æ”¹é€ èŠå¤©ç•Œé¢

**ä¿®æ”¹**ï¼š`frontend/src/App.tsx`

**æ–°å¢åŠŸèƒ½**ï¼š
1. **å›¾ç‰‡ä¸Šä¼ æŒ‰é’®**
   - ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡
   - æ˜¾ç¤ºå›¾ç‰‡é¢„è§ˆ
   - å¯åˆ é™¤é‡é€‰

2. **æ¶ˆæ¯ç±»å‹æ‰©å±•**
   ```typescript
   interface Message {
     role: 'user' | 'assistant';
     content: string;
     image?: string;      // æ–°å¢ï¼šå›¾ç‰‡URL
     imageFile?: File;    // æ–°å¢ï¼šå›¾ç‰‡æ–‡ä»¶
   }
   ```

3. **å›¾ç‰‡æ¶ˆæ¯æ¸²æŸ“**
   ```tsx
   {message.image && (
     <img src={message.image} alt="ç”¨æˆ·ä¸Šä¼ " />
   )}
   ```

### 6.3 æ·»åŠ çŸ¥è¯†åº“ç®¡ç†åŠŸèƒ½

**æ–°å»º**ï¼š`frontend/src/components/MultimodalKnowledge.tsx`

**åŠŸèƒ½**ï¼š
- âœ… ä¸Šä¼ å›¾ç‰‡åˆ°çŸ¥è¯†åº“
- âœ… ä¸Šä¼  PDF åˆ°çŸ¥è¯†åº“
- âœ… æŸ¥çœ‹å·²ä¸Šä¼ æ–‡ä»¶
- âœ… åˆ é™¤æ–‡ä»¶

---

## ğŸ”„ é˜¶æ®µ7ï¼šæµ‹è¯•ä¸ä¼˜åŒ–

### 7.1 åŠŸèƒ½æµ‹è¯•

**æ–‡æœ¬çŸ¥è¯†åº“æµ‹è¯•**ï¼š
```bash
# æ·»åŠ æ–‡æœ¬çŸ¥è¯†
curl -X POST http://localhost:8001/api/v1/knowledge/add \
  -H "Content-Type: application/json" \
  -d '{"content": "äº§å“å›¾ç‰‡å±•ç¤º", "category": "äº§å“"}'

# æ£€ç´¢
curl -X GET "http://localhost:8001/api/v1/knowledge/search?query=äº§å“"
```

**å›¾ç‰‡çŸ¥è¯†åº“æµ‹è¯•**ï¼š
```bash
# ä¸Šä¼ å›¾ç‰‡
curl -X POST http://localhost:8001/api/v1/knowledge/upload-image \
  -F "file=@product.jpg" \
  -F "category=äº§å“å›¾ç‰‡" \
  -F "description=æ–°æ¬¾äº§å“"

# ä»¥å›¾æœå›¾
curl -X POST http://localhost:8001/api/v1/knowledge/search-by-image \
  -F "file=@query.jpg" \
  -F "top_k=5"
```

**PDF æµ‹è¯•**ï¼š
```bash
# ä¸Šä¼  PDF
curl -X POST http://localhost:8001/api/v1/knowledge/upload-pdf \
  -F "file=@manual.pdf" \
  -F "category=äº§å“æ‰‹å†Œ"
```

**å¤šæ¨¡æ€å¯¹è¯æµ‹è¯•**ï¼š
```bash
# å›¾æ–‡å¯¹è¯
curl -X POST http://localhost:8001/api/v1/chat/chat-with-image \
  -F "question=è¿™æ˜¯ä»€ä¹ˆäº§å“ï¼Ÿ" \
  -F "image=@product.jpg"
```

### 7.2 æ€§èƒ½ä¼˜åŒ–

**å›¾ç‰‡å¤„ç†ä¼˜åŒ–**ï¼š
```python
# 1. å›¾ç‰‡å‹ç¼©ï¼ˆå‡å°‘å­˜å‚¨ï¼‰
def compress_image(image: Image, max_size: tuple = (800, 800)):
    image.thumbnail(max_size, Image.LANCZOS)
    return image

# 2. æ‰¹é‡ç¼–ç ï¼ˆæé«˜æ•ˆç‡ï¼‰
def encode_images_batch(images: List[Image], batch_size: int = 32):
    for i in range(0, len(images), batch_size):
        batch = images[i:i+batch_size]
        yield model.encode(batch)

# 3. ç¼“å­˜æ¨¡å‹ï¼ˆé¿å…é‡å¤åŠ è½½ï¼‰
@lru_cache(maxsize=1)
def get_clip_model():
    return CLIPModel.from_pretrained(...)
```

**æ£€ç´¢ä¼˜åŒ–**ï¼š
```python
# 1. ä½¿ç”¨æ›´å¿«çš„ç´¢å¼•
index_params = {
    'metric_type': 'COSINE',
    'index_type': 'HNSW',  # æ¯” IVF_FLAT æ›´å¿«
    'params': {'M': 16, 'efConstruction': 256}
}

# 2. åˆ†ç±»è¿‡æ»¤
expr = f'content_type == "image" AND category == "äº§å“"'

# 3. æ··åˆæ£€ç´¢æƒé‡
text_weight = 0.6
image_weight = 0.4
final_score = text_score * text_weight + image_score * image_weight
```

---

## ğŸ“Š æ•°æ®ç»“æ„è®¾è®¡

### Collection è®¾è®¡ï¼ˆæœ€ç»ˆç‰ˆï¼‰

```python
knowledge_base_multimodal = {
    'name': 'knowledge_base',
    'fields': [
        {'name': 'id', 'type': 'VARCHAR', 'primary': True},
        {'name': 'content', 'type': 'VARCHAR'},           # æ–‡æœ¬å†…å®¹æˆ–æè¿°
        {'name': 'vector', 'type': 'FLOAT_VECTOR', 'dim': 512},
        {'name': 'content_type', 'type': 'VARCHAR'},      # text/image/pdf
        {'name': 'category', 'type': 'VARCHAR'},
        {'name': 'file_path', 'type': 'VARCHAR'},         # æ–‡ä»¶å­˜å‚¨è·¯å¾„
        {'name': 'file_size', 'type': 'INT64'},
        {'name': 'created_at', 'type': 'VARCHAR'},
        {'name': 'metadata', 'type': 'JSON'},             # é¢å¤–å…ƒæ•°æ®
    ]
}
```

### æ–‡ä»¶å­˜å‚¨ç»“æ„

```
backend/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ images/           # å›¾ç‰‡å­˜å‚¨
â”‚   â”‚   â”œâ”€â”€ 2025/
â”‚   â”‚   â”‚   â””â”€â”€ 10/
â”‚   â”‚   â”‚       â””â”€â”€ abc123.jpg
â”‚   â”œâ”€â”€ pdfs/             # PDF å­˜å‚¨
â”‚   â”‚   â””â”€â”€ 2025/
â”‚   â”‚       â””â”€â”€ 10/
â”‚   â”‚           â””â”€â”€ doc456.pdf
â”‚   â””â”€â”€ thumbnails/       # ç¼©ç•¥å›¾
â”‚       â””â”€â”€ abc123_thumb.jpg
```

---

## ğŸ¯ å®æ–½ä¼˜å…ˆçº§å»ºè®®

### ä¼˜å…ˆçº§1ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰- å¿…é¡»å®ç°
1. âœ… å®‰è£…ä¾èµ–
2. âœ… å›¾ç‰‡å‘é‡åŒ–ï¼ˆCLIPï¼‰
3. âœ… æ‰©å±• Milvus Schema
4. âœ… å›¾ç‰‡ä¸Šä¼  API
5. âœ… å‰ç«¯å›¾ç‰‡ä¸Šä¼ 

**é¢„è®¡æ—¶é—´**ï¼š4-6 å°æ—¶

### ä¼˜å…ˆçº§2ï¼ˆå¢å¼ºåŠŸèƒ½ï¼‰- æ¨èå®ç°
1. âœ… PDF è§£æ
2. âœ… ä»¥å›¾æœå›¾
3. âœ… å¤šæ¨¡æ€å¯¹è¯
4. âœ… çŸ¥è¯†åº“ç®¡ç†ç•Œé¢

**é¢„è®¡æ—¶é—´**ï¼š4-6 å°æ—¶

### ä¼˜å…ˆçº§3ï¼ˆä¼˜åŒ–åŠŸèƒ½ï¼‰- å¯é€‰å®ç°
1. â­ OCR æ”¯æŒ
2. â­ å›¾ç‰‡å‹ç¼©
3. â­ ç¼“å­˜ä¼˜åŒ–
4. â­ æ‰¹é‡ä¸Šä¼ 

**é¢„è®¡æ—¶é—´**ï¼š2-3 å°æ—¶

---

## ğŸš€ å¿«é€Ÿå¼€å§‹å»ºè®®

### æ–¹æ¡ˆAï¼šå®Œæ•´å®æ–½ï¼ˆæ¨èï¼‰

æŒ‰ç…§ 7 ä¸ªé˜¶æ®µä¾æ¬¡å®æ–½ï¼Œæœ€ç»ˆè·å¾—å®Œæ•´çš„å¤šæ¨¡æ€åŠŸèƒ½ã€‚

**æ—¶é—´**ï¼š8-15 å°æ—¶  
**é€‚åˆ**ï¼šæœ‰å……è¶³æ—¶é—´ï¼Œæƒ³è¦å®Œæ•´åŠŸèƒ½

### æ–¹æ¡ˆBï¼šæœ€å°å¯è¡Œæ–¹æ¡ˆï¼ˆMVPï¼‰

åªå®ç°æ ¸å¿ƒåŠŸèƒ½ï¼š
1. å®‰è£… CLIP æ¨¡å‹
2. å›¾ç‰‡å‘é‡åŒ–
3. å›¾ç‰‡ä¸Šä¼  API
4. ç®€å•çš„å‰ç«¯ä¸Šä¼ 

**æ—¶é—´**ï¼š4-6 å°æ—¶  
**é€‚åˆ**ï¼šå¿«é€ŸéªŒè¯æ¦‚å¿µ

### æ–¹æ¡ˆCï¼šæ¸è¿›å¼å®æ–½

åˆ†å¤šæ¬¡å®æ–½ï¼š
- **ç¬¬1æ¬¡**ï¼šå›¾ç‰‡åŠŸèƒ½ï¼ˆ2-3å°æ—¶ï¼‰
- **ç¬¬2æ¬¡**ï¼šPDF åŠŸèƒ½ï¼ˆ2-3å°æ—¶ï¼‰
- **ç¬¬3æ¬¡**ï¼šç•Œé¢ä¼˜åŒ–ï¼ˆ2-3å°æ—¶ï¼‰

**æ—¶é—´**ï¼šåˆ†æ•£è¿›è¡Œ  
**é€‚åˆ**ï¼šæ—¶é—´ç¢ç‰‡åŒ–

---

## ğŸ“‹ æ£€æŸ¥æ¸…å•

### å¼€å§‹å‰æ£€æŸ¥
- [ ] Docker è¿è¡Œæ­£å¸¸
- [ ] Milvus è¿è¡Œæ­£å¸¸
- [ ] åç«¯æœåŠ¡æ­£å¸¸
- [ ] å‰ç«¯æœåŠ¡æ­£å¸¸
- [ ] æœ‰æµ‹è¯•å›¾ç‰‡å’Œ PDF æ–‡ä»¶

### å®æ–½ä¸­æ£€æŸ¥
- [ ] ä¾èµ–å®‰è£…æˆåŠŸ
- [ ] CLIP æ¨¡å‹ä¸‹è½½å®Œæˆ
- [ ] Milvus Schema åˆ›å»ºæˆåŠŸ
- [ ] API æµ‹è¯•é€šè¿‡
- [ ] å‰ç«¯åŠŸèƒ½æ­£å¸¸

### å®Œæˆåæ£€æŸ¥
- [ ] å¯ä»¥ä¸Šä¼ å›¾ç‰‡
- [ ] å¯ä»¥ä»¥å›¾æœå›¾
- [ ] å¯ä»¥ä¸Šä¼  PDF
- [ ] å¤šæ¨¡æ€å¯¹è¯æ­£å¸¸
- [ ] æ€§èƒ½å¯æ¥å—

---

## ğŸ’¡ é‡è¦æç¤º

### 1. å‘é‡ç»´åº¦å˜åŒ–

**å…³é”®å†³ç­–**ï¼š
- å½“å‰ï¼š384 ç»´ï¼ˆsentence-transformersï¼‰
- æ”¹ä¸ºï¼š512 ç»´ï¼ˆCLIPï¼‰

**å½±å“**ï¼š
- âŒ ä¸å…¼å®¹ï¼å¿…é¡»é‡å»º Collection
- âœ… ä½†æ•°æ®é‡å°ï¼Œå½±å“ä¸å¤§

### 2. æ¨¡å‹é€‰æ‹©

**CLIP æ¨¡å‹å¯¹æ¯”**ï¼š

| æ¨¡å‹ | å¤§å° | é€Ÿåº¦ | ä¸­æ–‡æ”¯æŒ | æ¨è |
|------|------|------|---------|------|
| openai/clip-vit-base-patch32 | 600MB | å¿« | ä¸€èˆ¬ | â­â­â­â­ |
| openai/clip-vit-large-patch14 | 1.7GB | æ…¢ | ä¸€èˆ¬ | â­â­â­ |
| OFA-Sys/chinese-clip-vit-base | 800MB | å¿« | å¥½ | â­â­â­â­â­ |

**å»ºè®®**ï¼šå…ˆç”¨ base æ¨¡å‹éªŒè¯ï¼Œéœ€è¦æ—¶å‡çº§ã€‚

### 3. å­˜å‚¨è€ƒè™‘

**æ–‡ä»¶å­˜å‚¨é€‰é¡¹**ï¼š
- **æœ¬åœ°å­˜å‚¨**ï¼ˆå½“å‰ï¼‰ï¼šç®€å•ï¼Œé€‚åˆå¼€å‘
- **MinIO**ï¼ˆæ¨èï¼‰ï¼šMilvus è‡ªå¸¦ï¼Œå·²æœ‰å®¹å™¨
- **é˜¿é‡Œäº‘ OSS**ï¼šç”Ÿäº§ç¯å¢ƒ

### 4. æ€§èƒ½é¢„æœŸ

**å¤„ç†æ—¶é—´ä¼°ç®—**ï¼š
- å›¾ç‰‡ç¼–ç ï¼š~100ms/å¼ 
- PDF è§£æï¼š~1-5ç§’/é¡µ
- å‘é‡æ£€ç´¢ï¼š~10-50ms

---

## ğŸ“ å­¦ä¹ èµ„æº

### CLIP æ¨¡å‹
- è®ºæ–‡ï¼šhttps://arxiv.org/abs/2103.00020
- Hugging Faceï¼šhttps://huggingface.co/openai/clip-vit-base-patch32

### Milvus å¤šæ¨¡æ€
- å®˜æ–¹æ•™ç¨‹ï¼šhttps://milvus.io/docs/image_similarity_search.md
- æœ€ä½³å®è·µï¼šhttps://milvus.io/docs/multimodal_rag.md

### PDF å¤„ç†
- PyMuPDF æ–‡æ¡£ï¼šhttps://pymupdf.readthedocs.io/
- PDF2Imageï¼šhttps://github.com/Belval/pdf2image

---

## âœ… æ€»ç»“

### æ ¸å¿ƒæ”¹å˜

1. **æ¨¡å‹å±‚**ï¼šæ·»åŠ  CLIP å¤šæ¨¡æ€ç¼–ç å™¨
2. **æ•°æ®å±‚**ï¼šMilvus Schema æ‰©å±•ï¼ˆ512ç»´ï¼‰
3. **æœåŠ¡å±‚**ï¼šæ‰©å±•çŸ¥è¯†åº“æœåŠ¡
4. **APIå±‚**ï¼šæ–°å¢ä¸Šä¼ å’Œæ£€ç´¢æ¥å£
5. **å‰ç«¯å±‚**ï¼šæ·»åŠ æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½

### å·¥ä½œé‡ä¼°ç®—

- **æœ€å°æ–¹æ¡ˆ**ï¼š4-6 å°æ—¶
- **æ ‡å‡†æ–¹æ¡ˆ**ï¼š8-12 å°æ—¶
- **å®Œæ•´æ–¹æ¡ˆ**ï¼š12-15 å°æ—¶

### å»ºè®®

**æ¨èä» MVP å¼€å§‹**ï¼š
1. å…ˆå®ç°å›¾ç‰‡ä¸Šä¼ å’Œæ£€ç´¢
2. éªŒè¯æ•ˆæœ
3. å†æ‰©å±• PDF å’Œä¼˜åŒ–åŠŸèƒ½

---

**å‡†å¤‡å¥½å¼€å§‹äº†å—ï¼Ÿå‘Šè¯‰æˆ‘æ‚¨æƒ³ä»å“ªä¸ªé˜¶æ®µå¼€å§‹ï¼** ğŸš€

