# ğŸš€ éƒ¨ç½²æ–¹æ¡ˆå·²å®Œæˆ - æ–‡ä»¶æ¸…å•

## âœ… éƒ¨ç½²æ–¹æ¡ˆå®Œæˆ

æ‰€æœ‰éƒ¨ç½²æ–‡ä»¶å·²åˆ›å»ºå®Œæˆï¼Œæ‚¨ç°åœ¨å¯ä»¥**ä¸€é”®éƒ¨ç½²**åˆ°æœåŠ¡å™¨ï¼

---

## ğŸ“ åˆ›å»ºçš„æ–‡ä»¶åˆ—è¡¨

### 1. Docker ç›¸å…³

| æ–‡ä»¶ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| **åç«¯ Dockerfile** | `backend/Dockerfile` | åç«¯æœåŠ¡å®¹å™¨åŒ–é…ç½® |
| **å‰ç«¯ Dockerfile** | `frontend/Dockerfile` | å‰ç«¯æœåŠ¡å®¹å™¨åŒ–é…ç½®ï¼ˆå¤šé˜¶æ®µæ„å»ºï¼‰|
| **å‰ç«¯ Nginxé…ç½®** | `frontend/nginx.conf` | å‰ç«¯å®¹å™¨å†… Nginx é…ç½® |
| **Docker Compose** | `docker-compose.prod.yml` | ç”Ÿäº§ç¯å¢ƒç¼–æ’é…ç½® |

### 2. Nginx é…ç½®

| æ–‡ä»¶ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| **ä¸»é…ç½®æ–‡ä»¶** | `nginx/nginx.conf` | Nginx ä¸»é…ç½® |
| **åº”ç”¨é…ç½®** | `nginx/conf.d/app.conf` | åå‘ä»£ç†é…ç½® |

### 3. éƒ¨ç½²è„šæœ¬

| æ–‡ä»¶ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| **ä¸€é”®éƒ¨ç½²è„šæœ¬** | `deploy.sh` | æœ¬åœ°æ‰§è¡Œçš„éƒ¨ç½²è„šæœ¬ â­ |
| **å¤‡ä»½è„šæœ¬** | `backup.sh` | æ•°æ®å¤‡ä»½è„šæœ¬ |

### 4. é…ç½®æ–‡ä»¶

| æ–‡ä»¶ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| **ç¯å¢ƒå˜é‡æ¨¡æ¿** | `env.production.template` | ç”Ÿäº§ç¯å¢ƒé…ç½®æ¨¡æ¿ |

### 5. æ–‡æ¡£

| æ–‡ä»¶ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| **éƒ¨ç½²æŒ‡å—** | `éƒ¨ç½²æŒ‡å—.md` | å®Œæ•´éƒ¨ç½²æ–‡æ¡£ ğŸ“– |
| **æ–‡ä»¶æ¸…å•** | `éƒ¨ç½²æ–‡ä»¶æ¸…å•.md` | æœ¬æ–‡ä»¶ |

---

## ğŸ¯ éƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       æœåŠ¡å™¨ (106.14.204.36)           â”‚
â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Nginx (80) - å…¥å£              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚            â”‚               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Frontend   â”‚  â”‚   Backend    â”‚   â”‚
â”‚  â”‚  Container  â”‚  â”‚   Container  â”‚   â”‚
â”‚  â”‚   (3000)    â”‚  â”‚    (8001)    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚      Milvus + etcd + minio       â”‚ â”‚
â”‚  â”‚         (19530, 2379, 9000)      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³•ä¸€ï¼šä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰

```bash
# åœ¨æœ¬åœ°é¡¹ç›®ç›®å½•æ‰§è¡Œ
bash deploy.sh
```

**è‡ªåŠ¨å®Œæˆ**ï¼š
1. âœ… ç¯å¢ƒæ£€æŸ¥
2. âœ… è¿æ¥æµ‹è¯•
3. âœ… ä»£ç åŒæ­¥
4. âœ… Docker å®‰è£…
5. âœ… æœåŠ¡æ„å»º
6. âœ… æœåŠ¡å¯åŠ¨
7. âœ… å¥åº·æ£€æŸ¥

**é¢„è®¡æ—¶é—´**ï¼š10-15 åˆ†é’Ÿ

---

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²

è¯¦è§ [éƒ¨ç½²æŒ‡å—.md](./éƒ¨ç½²æŒ‡å—.md)

---

## ğŸ“¦ éƒ¨ç½²å†…å®¹

### æœåŠ¡ç»„æˆ

| æœåŠ¡ | é•œåƒ | ç«¯å£ | è¯´æ˜ |
|------|------|------|------|
| **Frontend** | è‡ªæ„å»º | 80 (å†…éƒ¨3000) | React åº”ç”¨ |
| **Backend** | è‡ªæ„å»º | 8001 | FastAPI åº”ç”¨ |
| **Nginx** | nginx:alpine | 80 | åå‘ä»£ç† |
| **Milvus** | milvusdb/milvus:v2.3.3 | 19530, 9091 | å‘é‡æ•°æ®åº“ |
| **etcd** | quay.io/coreos/etcd:v3.5.5 | 2379 | Milvus å…ƒæ•°æ® |
| **MinIO** | minio/minio | 9000, 9001 | Milvus å¯¹è±¡å­˜å‚¨ |

### æ•°æ®æŒä¹…åŒ–

```
volumes/
â”œâ”€â”€ etcd/          # Milvus å…ƒæ•°æ®
â”œâ”€â”€ minio/         # å‘é‡æ•°æ®å­˜å‚¨
â”œâ”€â”€ milvus/        # Milvus æ•°æ®
â”œâ”€â”€ backend/data/  # åç«¯æ•°æ®
â””â”€â”€ logs/          # åº”ç”¨æ—¥å¿—
    â”œâ”€â”€ backend/
    â””â”€â”€ nginx/
```

---

## ğŸ” å®‰å…¨é…ç½®

### å·²é…ç½®

- âœ… å®¹å™¨ç½‘ç»œéš”ç¦»
- âœ… å¥åº·æ£€æŸ¥
- âœ… èµ„æºé™åˆ¶ï¼ˆå¯é€‰ï¼‰
- âœ… æ—¥å¿—ç®¡ç†
- âœ… æ•°æ®å¤‡ä»½

### å»ºè®®é…ç½®

- [ ] HTTPS/SSL è¯ä¹¦ï¼ˆå¦‚æœ‰åŸŸåï¼‰
- [ ] API è®¿é—®é™åˆ¶
- [ ] æ•°æ®åº“è®¿é—®æ§åˆ¶
- [ ] å®šæ—¶å¤‡ä»½ä»»åŠ¡

---

## ğŸ“Š éƒ¨ç½²åéªŒè¯

### 1. æœåŠ¡çŠ¶æ€æ£€æŸ¥

```bash
# SSH è¿æ¥æœåŠ¡å™¨
ssh root@106.14.204.36

# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
cd /root/anti-aging-system
docker-compose -f docker-compose.prod.yml ps
```

**é¢„æœŸè¾“å‡º**ï¼š
```
NAME                       STATUS      PORTS
backend                    Up          0.0.0.0:8001->8001/tcp
frontend                   Up          0.0.0.0:3000->80/tcp
nginx                      Up          0.0.0.0:80->80/tcp
milvus-standalone          Up          0.0.0.0:19530->19530/tcp
etcd                       Up
minio                      Up
```

### 2. è®¿é—®æµ‹è¯•

**å‰ç«¯åº”ç”¨**ï¼š
```bash
curl http://106.14.204.36
# åº”è¿”å› HTML å†…å®¹
```

**åç«¯å¥åº·æ£€æŸ¥**ï¼š
```bash
curl http://106.14.204.36/api/health
# åº”è¿”å›: {"status":"ok"}
```

**API æ–‡æ¡£**ï¼š
æµè§ˆå™¨è®¿é—®ï¼šhttp://106.14.204.36/api/docs

### 3. åŠŸèƒ½æµ‹è¯•

1. æ‰“å¼€å‰ç«¯ï¼šhttp://106.14.204.36
2. è¾“å…¥æµ‹è¯•é—®é¢˜
3. éªŒè¯å›ç­”æ˜¯å¦æ­£å¸¸
4. æµ‹è¯•å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½
5. æµ‹è¯•çŸ¥è¯†åº“æ·»åŠ 

---

## ğŸ› ï¸ å¸¸ç”¨è¿ç»´å‘½ä»¤

### æŸ¥çœ‹æ—¥å¿—

```bash
# æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs -f

# åç«¯æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs -f backend

# å‰ç«¯æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs -f frontend

# Milvus æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs -f milvus-standalone
```

### é‡å¯æœåŠ¡

```bash
# é‡å¯æ‰€æœ‰
docker-compose -f docker-compose.prod.yml restart

# é‡å¯åç«¯
docker-compose -f docker-compose.prod.yml restart backend

# é‡å¯å‰ç«¯
docker-compose -f docker-compose.prod.yml restart frontend
```

### æ›´æ–°ä»£ç 

```bash
# æœ¬åœ°æ‰§è¡Œ
bash deploy.sh

# æœåŠ¡å™¨æ‰‹åŠ¨æ›´æ–°
cd /root/anti-aging-system
docker-compose -f docker-compose.prod.yml up -d --build
```

### æ•°æ®å¤‡ä»½

```bash
# åœ¨æœåŠ¡å™¨æ‰§è¡Œ
cd /root/anti-aging-system
bash backup.sh

# æŸ¥çœ‹å¤‡ä»½
ls -lh /root/backups/
```

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šéƒ¨ç½²è„šæœ¬è¿æ¥å¤±è´¥

**å¯èƒ½åŸå› **ï¼š
- SSH ç«¯å£æœªå¼€æ”¾
- æœåŠ¡å™¨å¯†ç é”™è¯¯
- ç½‘ç»œè¿æ¥é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ‰‹åŠ¨æµ‹è¯•è¿æ¥
ssh root@106.14.204.36

# æ£€æŸ¥ç«¯å£
telnet 106.14.204.36 22
```

### é—®é¢˜2ï¼šDocker æ„å»ºå¤±è´¥

**å¯èƒ½åŸå› **ï¼š
- ç½‘ç»œé—®é¢˜
- ç£ç›˜ç©ºé—´ä¸è¶³
- ä¾èµ–ä¸‹è½½å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h

# æ¸…ç† Docker ç¼“å­˜
docker system prune -a

# é‡æ–°æ„å»º
docker-compose -f docker-compose.prod.yml build --no-cache
```

### é—®é¢˜3ï¼šæœåŠ¡å¯åŠ¨å¤±è´¥

**æŸ¥çœ‹è¯¦ç»†é”™è¯¯**ï¼š
```bash
docker-compose -f docker-compose.prod.yml logs backend
docker-compose -f docker-compose.prod.yml ps
```

**å¸¸è§é—®é¢˜**ï¼š
- ç«¯å£è¢«å ç”¨
- ç¯å¢ƒå˜é‡æœªé…ç½®
- Milvus æœªå°±ç»ª

---

## ğŸ“ è·å–å¸®åŠ©

### æ–‡æ¡£èµ„æº

- ğŸ“– [éƒ¨ç½²æŒ‡å—.md](./éƒ¨ç½²æŒ‡å—.md) - å®Œæ•´éƒ¨ç½²æ–‡æ¡£
- ğŸ“„ [é¡¹ç›®è¯¦ç»†è¯´æ˜.md](./é¡¹ç›®è¯¦ç»†è¯´æ˜.md) - é¡¹ç›®æŠ€æœ¯æ–‡æ¡£
- ğŸ“‹ [README.md](./README.md) - é¡¹ç›®è¯´æ˜

### åœ¨çº¿èµ„æº

- Docker æ–‡æ¡£: https://docs.docker.com
- Milvus æ–‡æ¡£: https://milvus.io/docs
- FastAPI æ–‡æ¡£: https://fastapi.tiangolo.com

---

## âœ… éƒ¨ç½²æ£€æŸ¥æ¸…å•

éƒ¨ç½²å‰ï¼š
- [ ] æœåŠ¡å™¨å¯ä»¥ SSH è¿æ¥
- [ ] æœåŠ¡å™¨å¼€æ”¾äº† 80 ç«¯å£
- [ ] æœ¬åœ°æœ‰ deploy.sh æ‰§è¡Œæƒé™
- [ ] ç¡®è®¤ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®

éƒ¨ç½²åï¼š
- [ ] æ‰€æœ‰å®¹å™¨éƒ½åœ¨è¿è¡Œ
- [ ] å‰ç«¯å¯ä»¥è®¿é—®
- [ ] åç«¯ API æ­£å¸¸
- [ ] Milvus è¿æ¥æˆåŠŸ
- [ ] æµ‹è¯•æ·»åŠ çŸ¥è¯†
- [ ] æµ‹è¯•å¯¹è¯åŠŸèƒ½
- [ ] é…ç½®å®šæ—¶å¤‡ä»½ï¼ˆå¯é€‰ï¼‰

---

## ğŸ‰ éƒ¨ç½²å®Œæˆ

æ­å–œï¼æ‚¨ç°åœ¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¸€é”®éƒ¨ç½²ï¼š

```bash
bash deploy.sh
```

éƒ¨ç½²æˆåŠŸåè®¿é—®ï¼š
- **å‰ç«¯**: http://106.14.204.36
- **APIæ–‡æ¡£**: http://106.14.204.36/api/docs

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ğŸš€

