# 文件导入格式说明

## 📋 各格式解析逻辑

### 1. JSON 格式（`.json`）

**解析逻辑**：数组中的每个对象就是一条知识条目

**格式要求**：
```json
[
  {
    "content": "知识内容1（必填）",
    "category": "分类1（可选，默认'未分类'）",
    "title": "标题1（可选）",
    "tags": ["标签1", "标签2"]  // 可选
  },
  {
    "content": "知识内容2",
    "category": "分类2"
  }
]
```

**示例**：3 个对象的数组 → 导入 3 条知识

---

### 2. CSV 格式（`.csv`）

**解析逻辑**：除了表头外，每一行就是一条知识条目

**格式要求**：
- 第一行必须是表头：`content,category,title,tags`
- `content` 和 `category` 列必须存在（category 可为空，默认为"未分类"）
- `title` 和 `tags` 列可选
- `tags` 列：多个标签用逗号分隔，如 `"标签1,标签2"`

**示例**：
```csv
content,category,title,tags
"知识内容1","分类1","标题1","标签1,标签2"
"知识内容2","分类2","",""
```

**解析结果**：2 行数据 → 导入 2 条知识

---

### 3. Excel 格式（`.xlsx`, `.xls`）

**解析逻辑**：除了表头外，每一行就是一条知识条目（与 CSV 相同）

**格式要求**：
- 第一行必须是表头：`content,category,title,tags`
- `content` 列必须存在且不能为空
- `category` 列可选（为空时默认为"未分类"）
- `title` 和 `tags` 列可选
- `tags` 列：多个标签用逗号分隔

**示例**：3 行数据（不含表头）→ 导入 3 条知识

**注意**：空行会被自动跳过

---

### 4. TXT 格式（`.txt`）

**解析逻辑**：每一行就是一条知识条目

**格式要求**：
- 每行一条知识
- 默认分类：使用导入时设置的 `default_category`（默认为"未分类"）
- 支持分隔符格式：`分类|内容`（可选）

**示例**：
```
这是第一条知识
这是第二条知识
分类1|这是第三条知识（指定分类）
```

**解析结果**：3 行 → 导入 3 条知识
- 第 1 条：内容="这是第一条知识"，分类="未分类"
- 第 2 条：内容="这是第二条知识"，分类="未分类"
- 第 3 条：内容="这是第三条知识（指定分类）"，分类="分类1"

**注意**：空行会被自动跳过

---

### 5. Markdown 格式（`.md`）

**解析逻辑**：按照标题层级分割，每个 `##` 标题下的内容是一条知识条目

**格式要求**：
- `# 分类名称`：一级标题，作为分类（作用于后续所有 `##` 条目）
- `## 知识标题`：二级标题，作为知识标题（可选）
- 二级标题后的内容直到下一个二级标题或一级标题为止，作为知识内容

**示例**：
```markdown
# 抗衰老研究

## NMN 补充方法
NMN 是一种 NAD+ 前体，建议每日补充 250-500mg。

## 运动建议
每周进行 150 分钟中等强度有氧运动。

# 营养学

## 地中海饮食
多吃蔬菜水果和健康脂肪。
```

**解析结果**：3 条知识
1. 内容="NMN 是一种 NAD+ 前体..."，分类="抗衰老研究"，标题="NMN 补充方法"
2. 内容="每周进行 150 分钟..."，分类="抗衰老研究"，标题="运动建议"
3. 内容="多吃蔬菜水果..."，分类="营养学"，标题="地中海饮食"

**注意**：
- 如果内容块在 `#` 分类下但没有 `##` 标题，标题为 `None`
- 如果 `##` 标题后没有内容，不会创建知识条目

---

### 6. PDF 格式（`.pdf`）

**解析逻辑**：每一页就是一条知识条目（与 PDF 的分页特性匹配）

**解析过程**：
1. 提取 PDF 每一页的文本内容
2. 清理文本格式（移除多余空白）
3. 每页创建一条知识条目

**格式要求**：
- PDF 文件必须包含可提取的文本（非纯图片 PDF）
- 每页自动设置标题为 `PDF 第 X 页`
- 分类使用导入时设置的 `default_category`（默认为"未分类"）

**示例**：5 页 PDF → 导入 5 条知识
- 第 1 条：内容=第 1 页文本，标题="PDF 第 1 页"，分类="未分类"
- 第 2 条：内容=第 2 页文本，标题="PDF 第 2 页"，分类="未分类"
- ...

**注意**：
- 如果某页提取不到文本，会跳过该页
- 如果整个 PDF 提取不到文本，会报错

---

## 🔄 格式对比总结

| 格式 | 分割方式 | 分类来源 | 标题来源 | 适用场景 |
|------|---------|---------|---------|---------|
| **JSON** | 数组元素 | `category` 字段 | `title` 字段 | 结构化数据，程序生成 |
| **CSV** | 表格行 | `category` 列 | `title` 列 | 简单表格，Excel 导出 |
| **Excel** | 表格行 | `category` 列 | `title` 列 | 复杂表格，多工作表 |
| **TXT** | 文本行 | 分隔符或默认 | 无 | 简单文本，逐行导入 |
| **Markdown** | `##` 标题块 | `#` 一级标题 | `##` 二级标题 | 文档结构，标题清晰 |
| **PDF** | PDF 页面 | 默认分类 | `PDF 第 X 页` | 文档分页，按页导入 |

## 💡 选择建议

- **批量结构化数据**：使用 JSON 或 CSV/Excel
- **简单文本逐条导入**：使用 TXT
- **文档按章节导入**：使用 Markdown
- **文档按页导入**：使用 PDF

